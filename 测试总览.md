# 测试工作：
- 1、模拟测试  把视频文件和log分解，放到测试平台，和mobileye的表现作比对  
- 2、路测 通过观察行车记录仪的视频记录，统计相对于mobileye，我们产品的误报率和漏报率，及对应的发生场景  
现在工作以路测为主（路测通过查看行车记录仪分析统计），模拟测试的功能没有完善（每次测试的结果不一样）

## 路测注意点：  
- 每次测试前，清空行车记录仪卡、采集器的数据，方便进行数据收集  
- 行车记录仪需要同时拍到mobile\m3\FPGA画面
- 以观察行车记录仪的视频分析为准，进行统计。路测时允许的话也进行测试记录  
- 测试路线的收集可以不关注  
- 可以通过行车记录仪的视频，观察车辆是否偏道（车头与车道是否有夹角），观察是否打转向灯（有打方向的滴答声），不能查看车速  
- vb\fcw误报，怎么判定前车还很远?答复：通过经验、mobile对比判断
- 现有HMW告警，后出现FCW告警，FCW出现较危险(速度很快，且以相对时间计算)
- 隔壁车道识别出来：当前车道前方有车时 这种情况算误报；当前车道没有车，不算误报  
- 路测是2个人，单独有人负责开车  
- 每次路测前，跟开发沟通测试点  
- 南京测试车辆有3台设备，一台mobileye,一台minieye,一台采集器（minieye功能退化而成），采集器负
责录像及采集mobileye的日志文件。测试数据从采集器上的SD卡获取


## 模拟测试注意点:  
- 通过vnc的地址向平台传输数据  
- 解析原始数据：采集器上的视频和log   解析方法见下  
**解析方法**  
*执行环境：linux(Ubuntu) 基于vnc远程桌面40.125.160.164:3   
数据库路径：/mtf/database  
image: 把视频转换成的照片存放至此目录  
log: 脚本运行后生成的有用log存放至此目录  
runtime: 可从此目录获取脚本需要运行的执行文件  
video: 把原始视频与对应log存放至此目录  
脚本路径：/mtf/database/tool 
logabc: 此目录里的脚本 handle_logtxt.py 可以进行步骤1的log分切  
unpack_video: 此目录里的脚本 unpack_all_cli.py 可以进行步骤1的视频转换操作  
runner: 此目录里的脚本 run_all_cli.py 可以批量处理视频信息收集,生成有用的log*   
---
### 步骤1 视频转换成照片、视频log分切
获取：视频、对应的log文件（放置目录：/mtf/database/video/local/vehicle/1215FCW）  *----先解 log，后解视频*
- log分切  
1. 进入目录：/home/sji32/mywork/dev/tool/logabc 配置para.json 文件，内容如下，路径对应log文件所在的目录（绝对路径）
```json
{  
     "video_path": "/mtf/database/video/local/vehicle/1215FCW"  
}
```
2. 执行脚本**handle_logtxt.py**  
$ python3 handle_logtxt.py para.json  
log分解完成，存放于同级目录
- 视频转换成照片  
1. 进入目录：/home/sji32/mywork/dev/tool/unpack_video 配置para.json 文件，视频路径对应视频所在的目录（绝对路径），照片路径对应于/mtf/database/image/local/vehicle/1215FCW ，内容如下，
```json
{  
     "image_path": "/mtf/database/image/local/vehicle/1215FCW",
     "video_path": "/mtf/database/video/local/vehicle/1215FCW"  
}  
```
2. 执行脚本**unpack_all_cli.py**   
$ python3 unpack_all_cli.py para.json  
视频转换成照片，照片存放于/mtf/database/image/local/vehicle/1215FCW    
**Attention: 步骤1涉及到的文件生成后务必不能移动（不能更换路径），否则会影响到python脚本的执行**
